(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t():"function"===typeof define&&define.amd?define([],t):"object"===typeof exports?exports["tiger-prawn-mbhand-app"]=t():e["tiger-prawn-mbhand-app"]=t()})(window,(function(){return function(e){function t(t){for(var a,o,c=t[0],s=t[1],l=t[2],p=0,d=[];p<c.length;p++)o=c[p],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&d.push(r[o][0]),r[o]=0;for(a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a]);u&&u(t);while(d.length)d.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],a=!0,c=1;c<n.length;c++){var s=n[c];0!==r[s]&&(a=!1)}a&&(i.splice(t--,1),e=o(o.s=n[0]))}return e}var a={},r={app:0},i=[];function o(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=a,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(n,a,function(t){return e[t]}.bind(null,a));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/childApp/tiger-prawn-mbhand/";var c=window["webpackJsonp_tiger-prawn-mbhand"]=window["webpackJsonp_tiger-prawn-mbhand"]||[],s=c.push.bind(c);c.push=t,c=c.slice();for(var l=0;l<c.length;l++)t(c[l]);var u=s;return i.push([0,"chunk-vendors"]),n()}({0:function(e,t,n){e.exports=n("cd49")},1:function(e,t){},"2d8c":function(e,t,n){},"2e2e":function(e,t,n){},"6dec":function(e,t,n){"use strict";var a=n("2e2e"),r=n.n(a);r.a},7929:function(e,t,n){},"82b5":function(e,t,n){"use strict";var a=n("2d8c"),r=n.n(a);r.a},"9b8e":function(e,t,n){},a4ac:function(e,t,n){},b656:function(e,t,n){"use strict";var a=n("b816"),r=n.n(a);r.a},b816:function(e,t,n){},cd49:function(e,t,n){"use strict";n.r(t);n("d3b7"),n("96cf"),n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("router-view")],1)},i=[],o=n("d4ec"),c=n("bee2"),s=n("99de"),l=n("7e84"),u=n("262e"),p=n("9ab4"),d=n("60a3"),f=function(e){function t(){return Object(o["a"])(this,t),Object(s["a"])(this,Object(l["a"])(t).apply(this,arguments))}return Object(u["a"])(t,e),Object(c["a"])(t,[{key:"mounted",value:function(){}}]),t}(d["c"]);f=p["a"]([d["a"]],f);var m=f,h=m,v=n("2877"),y=Object(v["a"])(h,r,i,!1,null,null,null),b=y.exports,w=n("8c4f"),g=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-layout",{attrs:{view:"lHh lpr lFf"}},[n("q-page-container",[n("router-view",{on:{openMenu:function(t){return e.$refs.drawer.show()},addcam:e.addcam}})],1)],1)},_=[],k=function(e){function t(){return Object(o["a"])(this,t),Object(s["a"])(this,Object(l["a"])(t).apply(this,arguments))}return Object(u["a"])(t,e),Object(c["a"])(t,[{key:"addcam",value:function(){var e=this;this.$refs.plus.style.display="block",this.$refs.plus.style.opacity="1",setTimeout((function(){e.$refs.plus.style.opacity="0",e.$refs.plus.style.display="none"}),1e3)}}]),t}(d["c"]);k=p["a"]([d["a"]],k);var O=k,j=O,x=(n("b656"),n("fe09")),C=Object(v["a"])(j,g,_,!1,null,null,null),S=C.exports;C.options.components=Object.assign({QLayout:x["g"],QHeader:x["d"],QToolbar:x["o"],QToolbarTitle:x["p"],QPageContainer:x["j"]},C.options.components||{});var M=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-page",{staticClass:"flex column flex-center"},[n("div",{staticClass:"area",staticStyle:{flex:"0 0 calc(31vh - 0px)"}},[n("q-card",{ref:"myvideo",staticClass:"container"},[n("q-btn",{directives:[{name:"show",rawName:"v-show",value:e.playing,expression:"playing"}],staticClass:"close",attrs:{color:"primary",round:"",size:"xs",icon:"close"},on:{click:e.relo}})],1)],1),n("div",{staticClass:"area",staticStyle:{flex:"0 0 30vh"}},[n("amap",{ref:"amap",staticStyle:{height:"30vh"}})],1),n("div",{staticClass:"area",staticStyle:{flex:"0 0 39vh","overflow-y":"scroll"}},[n("q-scroll-area",{staticStyle:{"overflow-y":"scroll"},scopedSlots:e._u([{key:"loading",fn:function(){return[n("div",{staticClass:"row justify-center q-my-md"},[n("q-spinner-dots",{attrs:{color:"primary",size:"40px"}})],1)]},proxy:!0}])},[n("q-tab-panels",{staticClass:"shadow-2 rounded-borders",attrs:{animated:""},model:{value:e.panel,callback:function(t){e.panel=t},expression:"panel"}},[n("q-tab-panel",{staticStyle:{width:"100%"},attrs:{name:"cam"}},[n("camList",{ref:"cam",attrs:{platId:e.platId},on:{showCamsInMap:e.showCamsInMap,selectCam:e.selectCam,addcam:e.addcam}})],1)],1)],1)],1)])},$=[],Q=(n("5319"),n("841c"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{ref:"minimap",staticClass:"minimap"})])}),q=[];n("7db0"),n("d81d"),n("b0c0"),n("159b");function E(e,t){return n(e);function n(e){var n=document.createElement("script");document.body.appendChild(n);var r=new Promise((function(e,r){n.addEventListener("load",(function(r){a(n),t||e(r)}),!1),n.addEventListener("error",(function(e){a(n),r(e)}),!1),t&&(window.____callback____=function(){e(),window.____callback____=null})}));return t&&(e+="&callback=____callback____"),n.src=e,r}function a(e){document.body.removeChild(e)}}var L=function(e){function t(){var e;return Object(o["a"])(this,t),e=Object(s["a"])(this,Object(l["a"])(t).apply(this,arguments)),e.zoom=null,e.myOptions={zoom:e.zoom||16,center:[121.57090365886688,31.113365946637597],viewMode:"3D",pitch:60,skyColor:"#fff",mapStyle:"amap://styles/night"},e.map=null,e.markerSet=[],e.infoWindow=null,e}return Object(u["a"])(t,e),Object(c["a"])(t,[{key:"showCams",value:function(e){var t=this;this.markerSet.length>0&&(this.map.remove(this.markerSet),this.markerSet=[]),0!==e.length&&e.forEach((function(e){var n=e.geomType?e.center:e.geom[0];n&&t.markerSet.push(t.drawMarker(e.id,n.lng,n.lat,e.name,e.url,e.ascriptionType))}))}},{key:"drawMarker",value:function(e,t,n,a,r,i){var o=new AMap.Marker({map:this.map,position:new AMap.LngLat(t,n),zIndex:20,title:a,extData:r});return{id:e,marker:o}}},{key:"clean",value:function(){this.markerSet=[],this.map.clearMap()}},{key:"selectCam",value:function(e){var t=this.markerSet.find((function(t){return t.id===e.id}));this.flyTo(t.marker),this.infoWindow.setContent(t.marker.getTitle()||"选中"),this.infoWindow.open(this.map,t.marker.getPosition())}},{key:"flyTo",value:function(e){var t;e&&(t=[e],this.map.setZoom(19),this.map.setPitch(0)),this.map.setFitView(t)}},{key:"init",value:function(){var e=this;this.$nextTick((function(){e.map=new AMap.Map(e.$refs.minimap,e.myOptions);var t=new AMap.InfoWindow({content:"",offset:new AMap.Pixel(0,-30)});e.infoWindow=t}))}},{key:"created",value:function(){var e=this;return regeneratorRuntime.async((function(t){while(1)switch(t.prev=t.next){case 0:return this.$q.loading.show(),t.next=3,regeneratorRuntime.awrap(E("https://webapi.amap.com/maps?v=1.4.15&key=4dcdc8c288e19164922e5b1539ceb0ba&plugin=AMap.PolyEditor&plugin=AMap.MouseTool&plugin=AMap.Autocomplete,AMap.PlaceSearch，AMap.Heatmap"));case 3:this.init(),setTimeout((function(){e.$q.loading.hide()}),1e3);case 5:case"end":return t.stop()}}),null,this)}}]),t}(d["c"]);L=p["a"]([d["a"]],L);var P=L,T=P,A=(n("f114"),Object(v["a"])(T,Q,q,!1,null,null,null)),I=A.exports,N=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{width:"100%"}},[n("q-list",{attrs:{bordered:"",separator:""}},e._l(this.platList,(function(t){return n("q-expansion-item",{key:t.id,attrs:{group:"somegroup","expand-separator":"",icon:"account_balance",label:t.name,caption:t.place},on:{show:function(n){return e.loadList(t.id)}}},[n("q-list",{attrs:{bordered:"",separator:""}},e._l(e.camsData,(function(t){return t.type?e._e():n("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:t.id,attrs:{clickable:"",active:e.active===t.id,"active-class":"bg-teal-1 text-blue-8"},on:{click:function(n){return e.selectCam(t)}}},[n("q-item-section",[e._v(e._s(t.name||"摄像头"))]),n("q-item-section",{attrs:{side:""},on:{click:function(n){return e.toggle(t,n)}}},[n("q-btn",{attrs:{round:"",push:"",color:"teal",icon:"local_see"}})],1)],1)})),1)],1)})),1)],1)},R=[],D=(n("a9e3"),n("2909")),z=n("bc3a"),B=n.n(z),W=(n("4328"),function(e){return B.a.get("/handapi/cam/pageList",{params:e}).then((function(e){return e.data}))}),H=function(){return B.a.get("/handapi/district/pageList").then((function(e){return e.data}))},V=function(e){function t(){var e;return Object(o["a"])(this,t),e=Object(s["a"])(this,Object(l["a"])(t).apply(this,arguments)),e.camsData=[],e.active=null,e.playing=[],e.page={pageNo:1,pageSize:20},e.platList=[],e}return Object(u["a"])(t,e),Object(c["a"])(t,[{key:"selectCam",value:function(e){this.active=e.id,this.$emit("selectCam",e)}},{key:"loadList",value:function(e){var t=this;return regeneratorRuntime.async((function(n){while(1)switch(n.prev=n.next){case 0:return this.camsData=[],n.next=3,regeneratorRuntime.awrap(W({districtId:e,pageNo:1,pageSize:100}).then((function(e){var n;(n=t.camsData).push.apply(n,Object(D["a"])(e.data.pageContent)),t.$emit("showCamsInMap",t.camsData)})));case 3:case"end":return n.stop()}}),null,this)}},{key:"toggle",value:function(e,t){var n={x:t.x,y:t.y};this.addToList(e,n,t.srcElement)}},{key:"addToList",value:function(e,t,n){return regeneratorRuntime.async((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,regeneratorRuntime.awrap(this.flyBall(t,n));case 2:this.$emit("addcam",e);case 3:case"end":return a.stop()}}),null,this)}},{key:"flyBall",value:function(e,t){var n,a;return regeneratorRuntime.async((function(r){while(1)switch(r.prev=r.next){case 0:return n=document.createElement("div"),n.className="ball-outer",a=document.createElement("div"),a.className="inner",n.appendChild(a),t.after(n),n.style.top=e.y+"px",n.style.left=e.x+"px",r.next=10,regeneratorRuntime.awrap(new Promise((function(e){setTimeout((function(){n.style.top="0",n.style.left="0",setTimeout((function(){n.remove(),e()}),700)}),200)})));case 10:case"end":return r.stop()}}))}},{key:"created",value:function(){var e=this;H().then((function(t){e.platList=t.data.pageContent,e.platList.map((function(e){return Object.assign(e,{expanded:!1})}))}))}}]),t}(d["c"]);p["a"]([Object(d["b"])(Number)],V.prototype,"platId",void 0),V=p["a"]([d["a"]],V);var F=V,J=F,K=(n("82b5"),Object(v["a"])(J,N,R,!1,null,null,null)),U=K.exports;K.options.components=Object.assign({QList:x["h"],QExpansionItem:x["c"],QItem:x["e"],QItemSection:x["f"],QBtn:x["a"]},K.options.components||{}),K.options.directives=Object.assign({Ripple:x["q"]},K.options.directives||{});var Y=n("f0e2"),Z=function(e){function t(){var e;return Object(o["a"])(this,t),e=Object(s["a"])(this,Object(l["a"])(t).apply(this,arguments)),e.search="",e.panel="",e.platId=null,e.platName="",e.player=null,e.playing=!1,e}return Object(u["a"])(t,e),Object(c["a"])(t,[{key:"mounted",value:function(){this.panel="cam"}},{key:"addcam",value:function(e){this.relo(),this.loadV(e)}},{key:"relo",value:function(){this.player&&(this.player.dispose(),this.player=null,this.playing=!1)}},{key:"loadV",value:function(e){var t=window.btoa(e.url),n=document.createElement("video");n.style.width="100%",n.style.height="100%",this.$refs.myvideo.$el.appendChild(n);var a="rtmp://58.247.128.138:1935/rtsp/".concat(t);a=a.replace(/rtmp/g,"http"),a=a.replace(/1935/g,"48088"),a+=".m3u8",this.player=Object(Y["a"])(n),this.player.src({src:a,type:"application/vnd.apple.mpegurl",overrideNative:!0,controls:!0,autoplay:!1,preload:"none",muted:!0}),this.player.play(),this.playing=!0}},{key:"selectCam",value:function(e){this.$refs.amap.selectCam(e)}},{key:"showCamsInMap",value:function(e){this.$refs.amap.showCams(e)}}]),t}(d["c"]);Z=p["a"]([Object(d["a"])({components:{Amap:I,camList:U}})],Z);var G=Z,X=G,ee=(n("6dec"),Object(v["a"])(X,M,$,!1,null,null,null)),te=ee.exports;ee.options.components=Object.assign({QPage:x["i"],QCard:x["b"],QBtn:x["a"],QScrollArea:x["k"],QTabPanels:x["n"],QTabPanel:x["m"],QSpinnerDots:x["l"]},ee.options.components||{});var ne=[{path:"/",component:S,children:[{path:"",component:te}]}],ae=ne;a["a"].use(w["a"]);var re=new w["a"]({base:window.__POWERED_BY_QIANKUN__?"/tiger-prawn-mbhand/":"/childApp/tiger-prawn-mbhand/",mode:"history",routes:ae}),ie=n("2f62");a["a"].use(ie["a"]);var oe=new ie["a"].Store({modules:{}}),ce=(n("a4ac"),n("7929"),n("e54f"),n("a4b7"),n("05bc"),n("0d0e"),n("b05d")),se=n("4983"),le=n("3b73"),ue=n("2a19"),pe=n("7518"),de=n("f508");a["a"].use(ce["a"],{config:{Loading:de["a"]},components:{QScrollArea:se["a"],QExpansionItem:le["a"]},directives:{},plugins:{Notify:ue["a"],BottomSheet:pe["a"],Loading:de["a"]}}),n.d(t,"bootstrap",(function(){return me})),n.d(t,"mount",(function(){return he})),n.d(t,"unmount",(function(){return ve}));var fe=null;function me(){return regeneratorRuntime.async((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}))}function he(){return regeneratorRuntime.async((function(e){while(1)switch(e.prev=e.next){case 0:fe=new a["a"]({el:"#app",router:re,store:oe,render:function(e){return e(b)}});case 1:case"end":return e.stop()}}))}function ve(){return regeneratorRuntime.async((function(e){while(1)switch(e.prev=e.next){case 0:fe.$destroy(),fe=null;case 2:case"end":return e.stop()}}))}!window.__POWERED_BY_QIANKUN__&&he()},f114:function(e,t,n){"use strict";var a=n("9b8e"),r=n.n(a);r.a}})}));
//# sourceMappingURL=app.ef881517.js.map